name: Free RDP with VSCode + C++ + Python

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    timeout-minutes: 360

    steps:
      - name: Enable RDP access
        run: |
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 0 -Force
          Enable-NetFirewallRule -DisplayGroup "Remote Desktop"
          net user runneradmin "Admin@123" 

      - name: Install Chocolatey
        shell: pwsh
        run: |
          Set-ExecutionPolicy Bypass -Scope Process -Force
          [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072
          iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

      - name: Install VSCode, Python, and C++
        shell: pwsh
        run: |
          choco install vscode python mingw -y
          if (!(Test-Path "C:\Tools")) { mkdir "C:\Tools" }

      - name: Show RDP Info
        run: |
          Write-Host "==============================="
          Write-Host "âœ… RDP is ready!"
          Write-Host "Username: runneradmin"
          Write-Host "Password: Admin@123"
          Write-Host "Use your GitHub Actions IP with port 3389 to connect."
          Write-Host "==============================="
          while ($true) { Start-Sleep -Seconds 300 }
